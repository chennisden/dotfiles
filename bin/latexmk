#! /usr/bin/bash
LATEXMK=$HOME/.local/bin/texlive/2021/bin/x86_64-linux/latexmk

[ -d build ] && mv build/* .

if [ -z "$1" ]
	then
		files=(*.tex)
		FILE=$(basename ${files[0]} .tex)
	else
		FILE=$(basename ${1} .tex)
fi

$LATEXMK $FILE.tex

# hint and solu are just what I commonly use for scrambledenvs
[ -d build ] || mkdir build
mv *.aux *.fdb_latexmk *.fls *.log *.out *.pdf *.pre *.toc *.asy *.hint *.solu build

mv build/$FILE.pdf $FILE.pdf

if [[ -z "$(pidof zathura ${FILE}.pdf)" && $2 -eq preview ]]
	then
		zathura $FILE.pdf &
fi
